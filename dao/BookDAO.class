package dao;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import model.Book;
import utility.Converter;

public class BookDAO implements IBookDAO {
    private Connection connection;
    
    public BookDAO(Connection connection) {
        this.connection = connection;
    }
    
    @Override
    public List<Book> getAllBooks() {
        List<Book> bookList = new ArrayList<Book>();
        Statement statement = null;
        ResultSet resultSet = null;
        try {
            statement = connection.createStatement();
            resultSet = statement.executeQuery("SELECT * FROM books ORDER BY title DESC");
            
            while(resultSet.next()) {
                Book book = Converter.convertRowToBook(resultSet);
                bookList.add(book);
            }
            return bookList;
        } catch(SQLException e) {
            e.printStackTrace();
            return null;
        } finally {
            try {
                statement.close();
                resultSet.close();
                //am I supposed to close connection at all?
                connection.close();
            } catch(SQLException ex) {
                System.err.print("Couldn't close DB connection");
                ex.printStackTrace();
            }
        }
    }

    @Override
    public List<Book> getStaleBooks() {
        return null;
    }

    @Override
    public void addBookToStock(Book book) { 
    }

    @Override
    public void removeBookFromStock(Book book) {    
    }

    @Override
    public Book getBookDescriprion() {
        // TODO Auto-generated method stub
        return null;
    }

}
